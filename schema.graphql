# Defined in the REST API, source unclear
type Contribution @entity {
  id: ID!
  address: Bytes!
  district: District!
  landCount: BigInt!
  timestamp: BigInt!
}

type District @entity {
  id: ID!
  name: String!
  description: String
  link: String!
  isPublic: Boolean!
  parcelCount: BigInt!
  parcels: [Parcel!]
  center: String!
  priority: String # Is this the real type?
  disabled: Boolean!
}

# aka land
type Parcel @entity {
  id: ID!
  x: BigInt
  y: BigInt
  district: District
  estate: Estate
  owner: Bytes
  data: ParcelData
  lastTransferredAt: BigInt
  auctionOwner: Bytes
  auctionPrice: BigInt
  activeAuction: Auction
  auctions: [Auction!] @derivedFrom(field: "parcel")
  createdAt: BigInt
  updatedAt: BigInt

  # Defined in the REST API, source unclear
  # tags: [ParcelTag!]
}

type ParcelData @entity {
  id: ID!
  parcel: Parcel!
  version: String
  name: String
  description: String
  ipns: String
}

# Defined in the REST API, source unclear
#
# type ParcelTag @entity {
#   id: ID!
#   # ...
# }

type Auction @entity {
  id: ID!
  type: AuctionType
  parcel: Parcel
  # Defined in the REST API, source unclear:
  # estate: Estate # TODO
  txHash: Bytes!
  txStatus: TransactionStatus
  owner: Bytes!
  price: BigInt!
  status: AuctionStatus
  buyer: Bytes
  contract: Bytes!
  blockNumber: BigInt!
  expiresAt: BigInt!
  blockTimeCreatedAt: BigInt!
  blockTimeUpdatedAt: BigInt
  marketplace: Bytes!
}

enum AuctionType @entity {
  parcel
  estate
}

enum AuctionStatus @entity {
  open
  sold
  cancelled
}

enum TransactionStatus @entity {
  confirmed
  pending
}

# Defined in contracts that are not deployed on mainnet yet:
#
# type Mortgage @entity {
#   id: ID!
#   txHash: Bytes!
#   txStatus: TransactionStatus!
#   blockNumber: BigInt!
#   status: MortgageStatus
#   type: MortgageType
#   parcel: Parcel
#   estate: Estate
#   borrower: Bytes
#   lender: Bytes!
#   loan_id: String!
#   mortgage_id: String!
#   amount: BigInt!
#   expiresAt: BigInt!
#   isDueAt: BigInt!
#   payableAt: BigInt!
#   startedAt: BigInt!
#   paid: BigInt!
#   interestRate: BigInt!
#   punitoryInterestRate: BigInt!
#   outstandingAmount: BigInt!
#   blockTimeCreatedAt: BigInt!
#   blockTimeUpdatedAt: BigInt
# }
#
# enum MortgageType @entity {
#   estate
#   parcel
# }
#
# enum MortgageStatus @entity {
#   pending
#   cancelled
#   ongoing
#   paid
#   defaulted
#   claimed
# }

# NEWWWWWWW BELOWWWWW HEREEEEE

# todo - estates can be added, districts still not needed,

# api - get : districts, estates, contributions, map (returns parcels), map.png (returns png), parcels, txHash, mortages ??? :O

# possible things to add - publication, tags -> proximity -> plaza -> road, data (of a parcel)

type Estate @entity {
  id: ID!       # estate ID (based on total supply of estates)
  owner: Bytes!
  operator: Bytes
  metaData: String  # Todo - make ! when not broken
  land: [BigInt!]   # AddLand and TransferLand events (need to indexOf and drop)
  size: BigInt!
  tx: Bytes
  sizeArray: Int!
}

type Order @entity {
  id: ID!
  seller: Bytes!
  nftAddress: Bytes!
  price: BigInt!
  expiresAt: BigInt!
}